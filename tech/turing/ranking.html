<!--
Generated by google gemini

prompts:

write a web app to do the following. the app should be a single html file containing css and js, it will all be client side. you can use tailwind for styles. the app will load a json file. add code to fetch the json file from a url (at the same domain) but comment it out for now; for now we'll just embed the json as a string. parse the json. the json will be an object, whose keys are identifiers and values are submissions. submissions are prose strings aroun 600 chars in length. the app helps users rank these prose by which is more human (this is for an in-class adaptation of the turing test experiment). the app will show the user two randomly submissions, and let the user choose which is more human (or authentic). After the user chooses, a new randomly pair is selected. there will be a couple dozen entries in the json file. a submissions shouldn't be ranked against itself. there should be a log part of the app that displays lines with the form identifierA,identifierB for each selection the user makes, where identifierA is the "winning" submission. the app should show how many rankings the user has done.

looks good. can you add a copy-text icon button for the selection log. also what happens if the submissions are longer (they'll be around 600 characters. Make sure they're displayed gracefully if they're long (make submission boxes scroll to show). Also show the identifier names above the two submission text boxes

actually lets say that json file is a list of objects, with the form { id: string, content: (string around 600 chars, multi line), tool: string, prompts: (string, multi-line) } we only need to use the id and content fields 
-->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Human Authenticity Rater</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Inter", sans-serif;
      }
      .prose-box {
        height: 300px; /* Fixed height for consistency */
        overflow-y: auto; /* Allow scrolling for longer text */
      }
    </style>
  </head>
  <body
    class="bg-gray-50 text-gray-800 flex flex-col items-center justify-center min-h-screen p-4"
  >
    <div class="w-full max-w-5xl mx-auto">
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Which is More Human?</h1>
        <p class="text-gray-600 mt-2">
          Choose the submission that you believe was written by a human.
        </p>
      </header>

      <!-- Main comparison section -->
      <main
        id="comparison-container"
        class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8"
      >
        <!-- Submission A -->
        <div class="flex flex-col">
          <h3 class="text-sm font-semibold mb-2 text-gray-500">
            Submission ID:
            <span
              id="submissionA-id"
              class="font-mono bg-gray-100 text-gray-800 py-1 px-2 rounded"
            ></span>
          </h3>
          <div
            id="submissionA-text"
            class="prose-box bg-white border border-gray-200 rounded-lg p-6 shadow-sm flex-grow"
          >
            <!-- Text for submission A goes here -->
          </div>
          <button
            id="chooseA-btn"
            class="mt-4 bg-blue-500 hover:bg-blue-600 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-300 shadow"
          >
            Choose This One
          </button>
        </div>

        <!-- Submission B -->
        <div class="flex flex-col">
          <h3 class="text-sm font-semibold mb-2 text-gray-500">
            Submission ID:
            <span
              id="submissionB-id"
              class="font-mono bg-gray-100 text-gray-800 py-1 px-2 rounded"
            ></span>
          </h3>
          <div
            id="submissionB-text"
            class="prose-box bg-white border border-gray-200 rounded-lg p-6 shadow-sm flex-grow"
          >
            <!-- Text for submission B goes here -->
          </div>
          <button
            id="chooseB-btn"
            class="mt-4 bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-4 rounded-lg transition-colors duration-300 shadow"
          >
            Choose This One
          </button>
        </div>
      </main>

      <!-- App Stats and Log -->
      <footer class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Stats -->
        <div class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
          <h2 class="text-lg font-semibold mb-2 text-gray-700">Stats</h2>
          <p>
            Rankings Completed:
            <span id="ranking-count" class="font-bold text-xl text-blue-600"
              >0</span
            >
          </p>
        </div>
        <!-- Log -->
        <div class="bg-white border border-gray-200 rounded-lg p-4 shadow-sm">
          <div class="flex justify-between items-center mb-2">
            <h2 class="text-lg font-semibold text-gray-700">
              Selection Log (Winner, Loser)
            </h2>
            <button
              id="copy-log-btn"
              title="Copy log to clipboard"
              class="text-gray-500 hover:text-gray-800 transition-colors p-1 rounded-md"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path
                  d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"
                ></path>
              </svg>
            </button>
          </div>
          <pre
            id="log-output"
            class="text-sm bg-gray-100 p-3 rounded-md h-40 overflow-y-auto whitespace-pre-wrap"
          ></pre>
        </div>
      </footer>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // --- UI Elements ---
        const submissionAText = document.getElementById("submissionA-text");
        const submissionBText = document.getElementById("submissionB-text");
        const submissionAIdEl = document.getElementById("submissionA-id");
        const submissionBIdEl = document.getElementById("submissionB-id");
        const chooseABtn = document.getElementById("chooseA-btn");
        const chooseBBtn = document.getElementById("chooseB-btn");
        const rankingCountEl = document.getElementById("ranking-count");
        const logOutputEl = document.getElementById("log-output");
        const copyLogBtn = document.getElementById("copy-log-btn");

        // --- State ---
        let submissions = {};
        let submissionIds = [];
        let currentPair = { A: null, B: null };
        let rankingCount = 0;
        let log = [];

        // --- Embedded JSON Data ---
        // For now, we use this embedded JSON string which is now an array of objects.
        // The logic will extract the 'id' and 'content' fields.
        const jsonString = `
            [
                { "id": "sub001", "content": "The sun dipped below the horizon, painting the sky in hues of orange and purple. It was a sight to behold, a daily masterpiece that never failed to inspire awe. For a moment, all the worries of the day melted away, replaced by a profound sense of peace and gratitude for the simple beauty of the world.", "tool": "human", "prompts": "Describe a sunset." },
                { "id": "sub002", "content": "Artificial intelligence is a fascinating field. The potential for machines to learn and adapt is both exciting and terrifying. We stand on the precipice of a new era, one where the very definition of intelligence may be redefined. The ethical implications are staggering, and we must proceed with caution and foresight.", "tool": "model_v1", "prompts": "Explain the concept of AI." },
                { "id": "sub003", "content": "I remember my grandmother's kitchen, the smell of baking bread and the comforting warmth of the wood-burning stove. It was a place of love and laughter, where stories were shared and memories were made. Those simple moments are the ones I cherish the most, a reminder of the importance of family and connection.", "tool": "human", "prompts": "Write about a cherished memory." },
                { "id": "sub004", "content": "The city is a symphony of sounds, a chaotic orchestra of car horns, sirens, and the distant rumble of the subway. Yet, within this cacophony, there is a rhythm, a pulse that is unique to urban life. It's a constant reminder of the millions of stories unfolding simultaneously, each one a thread in the city's rich tapestry.", "tool": "model_v2", "prompts": "Describe the sounds of a city." },
                { "id": "sub005", "content": "Climate change is the defining challenge of our generation. The science is clear, and the stakes could not be higher. We must transition to a sustainable future, not just for ourselves, but for generations to come. It will require collective action, innovation, and a fundamental shift in our relationship with the planet.", "tool": "model_v1", "prompts": "Explain the importance of addressing climate change." },
                { "id": "sub006", "content": "There's a special kind of magic to a rainy day. The gentle patter of drops against the windowpane, the cozy feeling of being indoors with a good book and a warm cup of tea. It's a time for reflection and introspection, a welcome respite from the hustle and bustle of everyday life.", "tool": "human", "prompts": "Describe a rainy day." },
                { "id": "sub007", "content": "The vastness of space is humbling. To look up at the night sky and see countless stars, each one a distant sun, is to be reminded of our own insignificance in the grand scheme of things. Yet, it also fills me with a sense of wonder and a desire to explore the unknown.", "tool": "model_v2", "prompts": "Write about looking at the stars." },
                { "id": "sub008", "content": "Music has a unique power to connect us. It transcends language and culture, speaking directly to our emotions. A single melody can evoke joy, sadness, or a sense of nostalgia. It's a universal language that reminds us of our shared humanity, the feelings that bind us all together in this complex world.", "tool": "human", "prompts": "Explain the power of music." },
                { "id": "sub009", "content": "The forest floor is a world of its own, a miniature ecosystem teeming with life. Mosses and fungi create a vibrant carpet, while insects and small animals scurry about their daily business. It’s a delicate balance, a reminder of the intricate web of life that sustains our planet and the need to protect these natural wonders.", "tool": "model_v1", "prompts": "Describe a forest floor." },
                { "id": "sub010", "content": "To truly understand another person, you must listen not just with your ears, but with your heart. Empathy is the bridge that connects us, allowing us to share in each other's joys and sorrows. In a world that often feels divided, it is the most powerful tool we have for fostering understanding and compassion.", "tool": "human", "prompts": "Define empathy." },
                { "id": "sub011", "content": "Creativity is not something you can force. It’s like a gentle stream that flows when you least expect it. The key is to be open to it, to create space for your mind to wander and make unexpected connections. The best ideas often come not from intense focus, but from moments of quiet contemplation and playfulness.", "tool": "model_v2", "prompts": "How does creativity work?" },
                { "id": "sub012", "content": "The ocean is a force of nature, both beautiful and terrifying. Its gentle waves can be calming, while its powerful storms can be destructive. It’s a constant reminder of the power and mystery of the natural world, a source of endless fascination and respect for the forces that shape our planet.", "tool": "human", "prompts": "Describe the ocean." }
            ]
            `;

        // --- Functions ---

        /**
         * Fetches and loads submission data.
         * Currently uses the embedded string, but can be switched to fetch from a URL.
         */
        async function loadSubmissions() {
          try {
            let sourceData;
            // --- OPTION 1: Parse the embedded JSON string (current method) ---
            sourceData = JSON.parse(jsonString);

            // --- OPTION 2: Fetch from a URL (commented out) ---
            // To use this, comment out the line above and uncomment the lines below.
            // Make sure you have a 'submissions.json' file in the same directory.
            /*
                    const response = await fetch('./submissions.json');
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    sourceData = await response.json();
                    */

            // Transform the array of objects into a key-value map for the app's logic
            submissions = sourceData.reduce((acc, item) => {
              if (item.id && item.content) {
                acc[item.id] = item.content;
              }
              return acc;
            }, {});

            submissionIds = Object.keys(submissions);
            if (submissionIds.length < 2) {
              showError(
                "Not enough valid submissions to compare. Please ensure the JSON has at least two items with 'id' and 'content' fields.",
              );
              return;
            }
            displayNewPair();
          } catch (error) {
            console.error("Failed to load submissions:", error);
            showError(
              "Could not load the submissions data. Please check the JSON format or the file path.",
            );
          }
        }

        /**
         * Displays an error message in the UI.
         * @param {string} message - The error message to display.
         */
        function showError(message) {
          const container = document.getElementById("comparison-container");
          container.innerHTML = `<div class="col-span-1 md:col-span-2 text-center bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg">${message}</div>`;
        }

        /**
         * Selects two unique, random submission IDs.
         */
        function selectRandomPair() {
          let indexA = Math.floor(Math.random() * submissionIds.length);
          let indexB = Math.floor(Math.random() * submissionIds.length);

          // Ensure the indices are different
          while (indexA === indexB) {
            indexB = Math.floor(Math.random() * submissionIds.length);
          }

          currentPair.A = submissionIds[indexA];
          currentPair.B = submissionIds[indexB];
        }

        /**
         * Renders the current pair of submissions to the UI.
         */
        function displayNewPair() {
          selectRandomPair();
          submissionAText.textContent = submissions[currentPair.A];
          submissionBText.textContent = submissions[currentPair.B];
          submissionAIdEl.textContent = currentPair.A;
          submissionBIdEl.textContent = currentPair.B;
        }

        /**
         * Handles the user's choice.
         * @param {string} winnerId - The ID of the chosen submission.
         * @param {string} loserId - The ID of the other submission.
         */
        function handleChoice(winnerId, loserId) {
          // 1. Update ranking count
          rankingCount++;
          rankingCountEl.textContent = rankingCount;

          // 2. Add to log
          const logEntry = `${winnerId},${loserId}`;
          log.push(logEntry);
          logOutputEl.textContent = log.join("\n");
          logOutputEl.scrollTop = logOutputEl.scrollHeight; // Auto-scroll to bottom

          // 3. Display a new pair
          displayNewPair();
        }

        // --- Event Listeners ---
        chooseABtn.addEventListener("click", () => {
          handleChoice(currentPair.A, currentPair.B);
        });

        chooseBBtn.addEventListener("click", () => {
          handleChoice(currentPair.B, currentPair.A);
        });

        copyLogBtn.addEventListener("click", () => {
          const textToCopy = logOutputEl.textContent;
          if (!textToCopy) return;

          // Use a temporary textarea to perform the copy command
          const tempTextArea = document.createElement("textarea");
          tempTextArea.value = textToCopy;
          document.body.appendChild(tempTextArea);
          tempTextArea.select();
          try {
            document.execCommand("copy");
            // Visual feedback
            const originalIcon = copyLogBtn.innerHTML;
            copyLogBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-green-500"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path><polyline points="22 4 12 14.01 9 11.01"></polyline></svg>`;
            setTimeout(() => {
              copyLogBtn.innerHTML = originalIcon;
            }, 2000);
          } catch (err) {
            console.error("Failed to copy log: ", err);
            alert("Failed to copy log to clipboard.");
          }
          document.body.removeChild(tempTextArea);
        });

        // --- Initial Load ---
        loadSubmissions();
      });
    </script>
  </body>
</html>
